\level{1}{Dashboard}
    Nel documento \insdoc{Specifica Tecnica v4.00} è stato definito in modo generale quali sono i componenti di cui è composta la \insglo{Dashboard} e ne sono stati definiti in modo preciso i ruoli. In esso, inoltre, è stato descritto il modo in cui l'utilizzatore di \insglo{Norris} deve procedere per creare e rendere disponibile la \insglo{Dashboard}.\\
    I task che lo sviluppatore deve eseguire durante la creazione della \insglo{Dashboard} sono talvolta complessi, nel senso che alcuni di essi implicano operazioni ulteriori rispetto al semplice uso dell' \insglo{API} interne fornite da \insglo{Norris}. Si è dunque deciso di suddividere l'intera logica di creazione e aggiornamento dei grafici e della pagina che andranno a formare la \insglo{Dashboard} in diverse funzioni. È stato fatto questo perché in tale modo il codice è più modulare e comprensibile.
    \level{2}{Funzioni}
        Nel presente paragrafo vengono presentate le funzioni nelle quali è stato suddiviso il codice necessario alla creazione e all'aggiornamento della \insglo{Dashboard}. Tali funzioni, si ricordi, fanno riferimento ai task che sono stati presentati e descritti nel documento \insdoc{Specifica Tecnica v4.00}.\\
        Si noti che le funzioni qui presentate rappresentano solo una ulteriore semplificazione fornita agli sviluppatori per creare una \insglo{Dashboard} basata sui dati messi a disposizione dall'\insglo{APS}. Nessuno vieta loro, infatti, di utilizzare in modo base le \insglo{API} interne che sono messe a disposizione da \insglo{Norris} e che sono descritte e documentate all'interno del presente documento.\\
        All'appendice \nameref{app:aps} si possono trovare le specifiche con le quali vengono effettuate le richieste al \insglo{server} \insglo{APS}. In tale appendice è riportato anche il formato della risposta che si ottiene, oltre ai criteri per interpretarlo.

        \begin{itemize}

            \item \ignoreglo{\textbf{init\_norris() : Norris}} \\
            Tale funzione ha il compito di inizializzare l'istanza di \insglo{Norris}. Ciò fa si che nel webserver si crei l'istanza vera e propria e ne vengano settate le impostazioni. Ne viene infine montato il \insglo{middleware} con express e ritornato.
            
            \item \ignoreglo{\textbf{init\_map(norris : Norris) : Chart}} \\
            Tale funzione ha il compito di inizializzare un \insglo{map chart} nell'istanza di \insglo{Norris}. Il chart non conterrà dati (che saranno inseriti in seguito, tramite aggiornamenti). Vengono inoltre impostate alcune opzioni di default. Il \insglo{map chart} che è stato creato da tale funzione viene ritornato, in modo che sia utilizzabile dallo sviluppatore in modo autonomo.
            
            \item \ignoreglo{\textbf{init\_bar(norris : Norris) : Chart}} \\
            Tale funzione ha il compito di inizializzare un \insglo{bar chart} nell'istanza di \insglo{Norris}. Il chart non conterrà dati (che saranno inseriti in seguito, tramite aggiornamenti). Vengono inoltre impostate alcune opzioni di default. Il \insglo{bar chart} che è stato creato da tale funzione viene ritornato, in modo che sia utilizzabile dallo sviluppatore in modo autonomo.
            
            \item \ignoreglo{\textbf{init\_table(norris : Norris) : Chart}} \\
            Tale funzione ha il compito di inizializzare una \insglo{table} nell'istanza di \insglo{Norris}. Il chart viene inizializzato con dati riguardanti alcuni dei principali punti di interesse di Padova (Prato della Valle, Stazione FS, Ospedale Civile), che però sono impostati su “unknown”. Essi saranno correttamente aggiornati in un momento successivo, quando vengono ricevuti i dati dal \insglo{server} \insglo{APS}.
            
            \item \ignoreglo{\textbf{init\_page(norris : Norris, charts : Chart[]) : Page}} \\
            Tale funzione ha il compito di inizializzare una pagina in una certa istanza di \insglo{Norris}. La pagina viene creata a partire dai grafici che sono stati passati come parametro alla funzione, e che presumibilmente (ma non obbligatoriamente) sono quelli ottenuti a partire dalle funzioni presentate in precedenza. Tale funzione si occupa inoltre di impostare alcune opzioni di default per la pagina.
            
            \item \ignoreglo{\textbf{getLines() : Dataset[]}} \\
            Tale funzione ha il compito di ottenere tutti i dati riguardanti le linee che il \insglo{server} \insglo{APS} mette a disposizione. Si noti che i dati che vengono ritornati sono nel formato fornito dall'\insglo{APS}, e quindi devono essere correttamente interpretati e convertiti prima di essere usati tramite le \insglo{API} di \insglo{Norris}. Il formato con il quale sono restituiti i dati da tale funzione sono descritti nell'appendice \nameref{app:aps}.
            
            \item \ignoreglo{\textbf{update\_map(chart : Chart, old\_values : Dataset[], new\_values : Dataset[]) : void}} \\
            Tale funzione ha il compito di aggiornare il \insglo{map chart} a partire dai dati che sono stati passati come parametro alla funzione. Tali dati sono quelli che sono stati ritornati dalla funzione getLines: essi sono dunque prima di tutto convertiti in un formato fruibile da \insglo{Norris}. In seguito, questi dati vengono utilizzati tramite le \insglo{API} interne per aggiornare il \insglo{map chart}: vengono aggiornate le posizioni di tutti i punti sulla mappa, vengono aggiunti eventuali nuovi punti e vengono tolti quelli non più presenti.
            
            \item \ignoreglo{\textbf{update\_bar(chart : Chart, old\_values : Dataset[], new\_values : Dataset[]) : void}} \\
            Tale funzione ha il compito di aggiornare il \insglo{bar chart} a partire dai dati che sono stati passati come parametro alla funzione. Tali dati sono quelli che sono stati ritornati dalla funzione getLines: essi devono dunque subire un'elaborazione, in quanto il \insglo{bar chart} deve contenere un'aggregazione dei dati che sono stati ottenuti, e non ogni singolo dato. In particolare, tale funzione si occupa di calcolare quanti mezzi sono attivi per ciascuna linea. A partire poi dal risultato ottenuto viene creato il pacchetto di aggiornamento tramite il quale le \insglo{API} interne possono effettuare l'aggiornamento vero e proprio del grafico.
            
            \item \ignoreglo{\textbf{update\_table(chart : Chart, old\_values : Dataset[], new\_values : Dataset[]) : void}} \\
            Tale funzione ha il compito di aggiornare la \insglo{table} a partire dai dati che sono stati passati come parametro alla funzione. Tali dati sono quelli che sono stati ritornati dalla funzione getLines: essi devono dunque subire un'elaborazione, in quanto la \insglo{table} deve contenere un'aggregazione dei dati che sono stati ottenuti, e non ogni singolo dato. In particolare, tale funzione si occupa di calcolare qual'è il mezzo più vicino ai vari punti di interesse e qual'è il tempo di attesa medio. A partire poi dal risultato ottenuto viene creato il pacchetto di aggiornamento tramite il quale le \insglo{API} interne possono effettuare l'aggiornamento vero e proprio del grafico.

        \end{itemize}